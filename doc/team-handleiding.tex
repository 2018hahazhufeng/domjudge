\documentclass[11pt,titlepage,a4paper]{article}

% $Id$

\usepackage{a4wide}
\usepackage{url}
\usepackage{verbatim}
\usepackage[dutch]{babel}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{epsfig}
\usepackage{bbm}
\usepackage{expdlist}

% Voor up-to-date definities van runlimits e.d.
\include{systemconfig}

\setlength{\parindent}{0pt}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}

\newcommand{\DOMjudge}{DOMjudge }

\title{Teamhandleiding\\~\\Nederlands Kampioenschap Programmeren 2004}

\begin{document}

\maketitle

\tableofcontents


\newpage
\section{De computers}

Alle teams krijgen \'e\'en computer aangewezen, waarop zij kunnen
werken om de opgaven op te lossen. Dit zijn computers van het
Informatica Instituut en zijn allemaal Dell computers met 15 inch TFT
flatscreens met een Intel Pentium 4 processor van minimaal 2 GHz.

Tijdens het NKP kan gebruik gemaakt worden van twee verschillende
besturingssystemen: Microsoft Windows 2000 Professional of
CentOS GNU/Linux (RedHat Enterprise). Beide draaien op dezelfde
hardware. Je keuze voor Windows of Linux moet je van tevoren
aangeven.

\section{Opgaven}

Voor iedere opgave is het noodzakelijk om de invoer van het probleem
in te lezen en het antwoord weer uit te voeren. Dit moet gedaan worden
via ``standaard invoer en uitvoer''. Je programma hoeft niet (en mag
ook niet) zelf bestanden openen, maar kan gewoon van de ``console''
lezen en schrijven. Je programma mag wel naar ``standard error''
schrijven, maar dit wordt genegeerd tijdens het jureren.

Verder bestaat de invoer van opgaven standaard uit meerdere
testgevallen. Als eerste is dan op \'e\'en regel het aantal
testgevallen gegeven en daarna volgen de testgevallen.

Zie verder bijlage \ref{codevoorbeeld} voor voorbeelden van code om
dit af te handelen.


\newpage
\section{Programmeertalen}

Tijdens het NKP kan gebruikt gemaakt worden van de programmeertalen C,
C++, Java, Pascal en Haskell. Je mag zelf weten in welke taal je een
oplossing instuurt: je mag verschillende opgaven in verschillende
talen proberen op te lossen en zelfs voor \'e\'en opgave oplossingen
in verschillende talen insturen.

Voor iedere taal zijn er afhankelijk van het platform waaronder je
werkt, verschillende compilers en IDE's aanwezig. De compiler die wij
gebruiken om je programma te compileren, staat aangegeven in tabel
\ref{compilercommandos}.

Hieronder staat per taal beschreven, welke compilers er
beschikbaar zijn en andere taalspecifieke details. Verder een beknopte
tabel (\ref{compilers}) met alle beschikbare compilers en welke versies.

\begin{table}[!ht]
\begin{center}
\caption{Beschikbare compilers}
\begin{tabular}{|l|c|c|}
\hline
Compiler & Linux versie & Windows versie \\
\hline
GCC             & \LINUXGCC     & \WINDOWSGCC   \\
MS Visual C++   &               & \WINDOWSMSC   \\
GCJ             & \LINUXGCJ     & \WINDOWSGCJ   \\
Sun Java        & \LINUXJAVA    & \WINDOWSJAVA  \\
FreePascal      & \LINUXFPC     & \WINDOWSFPC   \\
GPC             & \LINUXGPC     & \WINDOWSGPC   \\
GHC             & \LINUXGHC     & \WINDOWSGHC   \\
HUGS            & \LINUXHUGS    & \WINDOWSHUGS  \\
\hline
\end{tabular}
\label{compilers}
\end{center}
\end{table}


\subsection{C \& C++}

Onder Windows is GCC (de GNU C/C++ compiler collectie) beschikbaar
via Cygwin.

In C++ kan gebruik gemaakt worden van de Standard Template Library
(STL).

GCC ondersteunt de volledige ANSI C89 en C++ standaarden en GNU
extensies. Windows gebruikers moeten opletten, dat het type van een
64-bits integer \texttt{long long} is en dat alle STL datatypes binnen de
namespace \texttt{std} gedeclareerd zijn.

\subsection{Java}

Voor Java gebruiken wij niet de Java compiler van Sun zelf, maar de
compiler van GNU: GCJ versie \LINUXGCJ\
(\url{http://gcc.gnu.org/java/}). GCJ ondersteunt
alle delen van Java, die nodig zijn tijdens het NKP (niet relevante
delen, zoals java.swing en java.awt worden niet (volledig)
ondersteund).

De Java compiler van Sun zelf is ook beschikbaar en verder zullen de
JavaDocs beschikbaar zijn. Onder Windows staat er een link in het
startmenu en onder Linux is de link
\url{file:///usr/local/javadocs/index.html}.

Let op: de hoofdklasse van je programma moet \texttt{Main} (met
hoofdletter) heten en een public function \texttt{main} bevatten!

\subsection{Pascal}

Voor Pascal gebruiken wij de FreePascal compiler, versie
\LINUXFPC\ (\url{http://www.freepascal.org/}). Deze is onder
Linux en Windows beschikbaar. De bijbehorende IDE is niet
beschikbaar.

Verder is GNU GPC beschikbaar onder Windows via cygwin.

Let op dat het datatype \texttt{integer} de 16 bits \texttt{smallint}
is. Verder ondersteunt de compiler de ANSI Pascal standaard plus
nagenoeg alle Turbo Pascal uitbreidingen. Labels en \texttt{goto}
worden ook ondersteund.

\subsection{Haskell}

Waarschuwing vooraf: Haskell is een functionele programmeertaal en
verschilt daarmee erg van de andere (imperatieve) talen. We geven geen
garanties dat voor alle opgaven in Haskell een oplossing (binnen de
tijdslimiet) bestaat! Verder kan Haskell gewoon gebruikt worden.

Als compiler gebruiken we de Glasgow Haskell Compiler, GHC
(\url{http://www.haskell.org/ghc/}) versie \LINUXGHC. Deze compiler
ondersteund de volledige Haskell 98 standaard.

GHC en ook HUGS zijn beide beschikbaar onder Linux en Windows.


\newpage
\section{Het jurysysteem: \DOMjudge}

\subsection{Inleiding}

Dit hoofdstuk beschrijft de onderdelen van het \DOMjudge
jurysysteem, die aan de teams ter beschikking staan om oplossingen in
te sturen, uitslagen te bekijken en ``clarification requests'' te
sturen.

Het systeem is voor een groot deel gebaseerd op een webinterface. Het
insturen van oplossingen gaat echter via een command-line programma.

\subsection{Oplossingen insturen: \texttt{submit}}\label{submit}

Het insturen van oplossingen voor problemen gebeurt via een
command-line interface: het programma \texttt{submit} (onder Windows
\texttt{submit.exe}).

\textbf{Syntax:} \texttt{submit [opties] bestandsnaam.ext}

Het submit programma haalt de naam van het probleem uit
\texttt{bestandsnaam} en de de programmeertaal uit de extensie
\texttt{ext}. Dit kan handmatig aangepast worden met de opties
\texttt{-p probleemnaam} en \texttt{-l taalextensie}. Zie
\texttt{submit --help} voor een compleet overzicht van mogelijke
opties en extensies en een aantal voorbeelden. Let op, dat deze help-tekst
redelijk lang is en misschien niet op \'e\'en scherm past. Gebruik dan
bijvoorbeeld \texttt{submit --help | more} om alles te lezen.

\texttt{submit} zal het bestand controleren op een aantal eigenschappen
en eventueel waarschuwingen geven, zoals wanneer het bestand al lange
tijd niet veranderd is of groter is dan de maximale source-code grootte.

Hierna geeft \texttt{submit} een kort overzicht met de details van de
inzending en vraagt om bevestiging. Controleer vooral of je het goede
bestand, probleem en taal hebt en druk dan op `y' om de oplossing in
te sturen. Als alles goed gaat, zal \texttt{submit} een melding geven
dat de inzending succesvol is. Indien niet, zal er een foutmelding
verschijnen.

Het submit programma maakt gebruik van een directory \texttt{.submit}
in de homedirectory van het account (\texttt{cygwin$\backslash$.submit}
onder Windows). Hier slaat het tijdelijk
bestanden op voor inzending en staat ook een logfile \texttt{submit.log}.
Verwijder deze directory niet of pas hem niet aan, omdat anders het
submit programma eventueel niet meer correct functioneert. Verder
is een ``public ssh-key'' van de jury in de ssh configuratie
toegevoegd. Deze is ook nodig voor het functioneren van \texttt{submit}.
 
\subsection{De uitslag bekijken van inzendingen}

Op de team webpagina staat een overzicht van je inzendingen.
Dit overzicht bevat alle relevante gegevens: de tijd van inzending, de
programmeertaal, het probleem en de status. Het adres van je
teampagina is \url{http://judge.nkp.nl}. Hiervandaan kun je ook naar
de publieke pagina, waarop de scores van alle teams vermeld staan.

\subsubsection{Mogelijke uitslagen}

Op een ingestuurde oplossing zijn een aantal verschillende uitslagen
mogelijk. Hier volgen ze, met een korte beschrijving:

\begin{description}[\setleftmargin{4.5cm}]
\item[CORRECT]
Je oplossing was goed en je hebt dit probleem opgelost!

\item[COMPILER-ERROR]
Het compilen van je programma gaf een fout. Zie de inzendingsdetails
voor de precieze foutmelding. Compiler waarschuwingen worden niet als
fouten gezien, maar kun je eventueel wel bekijken bij de details van
je inzending.

\item[TIMELIMIT]
Je programma draaide langer dan de maximale toegestane tijd en is
afgebroken. Dit kan betekenen dat je programma ergens in een loop
blijft hangen, of dat je oplossing niet effici\"ent genoeg is.

\item[RUN-ERROR]
Je programma gaf een fout tijdens het uitvoeren. Dit kan verschillende
oorzaken hebben, zoals deling door nul, incorrecte geheugen adressering
(segfault, bijvoorbeeld door arrays buiten bereik te indiceren), te
veel geheugen gebruik, enzovoort\dots
Let ook op, dat je programma met een exitcode nul eindigt!

\item[NO-OUTPUT]
Je programma gaf geen uitvoer. Let op dat je uitvoer naar standard
output schrijft!

\item[WRONG-ANSWER]
De uitvoer van je programma was niet correct. Het kan zijn dat je
oplossing niet correct is, maar let ook goed op dat je de antwoorden
precies zoals beschreven uitvoert: de uitvoer moet exact kloppen met
de antwoorden van de jury!

\end{description}


\subsection{Clarification requests insturen}


\subsection{Hoe worden opgaven beoordeeld?}

Het \DOMjudge jurysysteem is volledig geautomatiseerd. Dit betekent
dat er (in principe) geen menselijke interactie is tijdens de
beoordeling. Het beoordelen gebeurt via de volgende stappen:

\subsubsection{Insturen}

Via het \texttt{submit} (zie \ref{submit}) programma kun je een
oplossing voor een opgave insturen. Let op dat je de source-code van
je programma moet insturen (en dus niet een gecompiled programma of de
uitvoer van je programma). \texttt{submit} maakt dan een verbinding
met een server en die kopieert je programma dan naar de
jury-computers.

Dan komt je programma in de wachtrij te staan, om gecompiled,
uitgevoerd en de uitvoer getest te worden op \'e\'en van de
jury-computers.

\subsubsection{Compileren}

Je programma wordt op een jury-computer onder Linux gecompiled. De
exacte compilers en opties die we gebruiken, staan in tabel
\ref{compilercommandos}. Als je een andere compiler of besturingssysteem
gebruikt, moet dat in principe geen probleem zijn, maar let wel op dat
je geen compiler/systeem-specifieke dingen gebruikt (bij een
compileerfout kun je altijd de foutmelding bekijken).

\begin{table}[!ht]
\caption{Compiler commando's}
\begin{tabular}{|l|l|l|}
\hline
programmeertaal & jury compiler-commando & niet-statisch gelinked \\
\hline
C       & \texttt{gcc -Wall -O2 -static -lm}         & \texttt{gcc -Wall -O2 -lm} \\
C++     & \texttt{g++ -Wall -O2 -static}             & \texttt{g++ -Wall -O2} \\
Java    & \texttt{gcj -Wall -O2 -static --main=Main} & \texttt{gcj -Wall -O2 --main=Main} \\
Pascal  & \texttt{fpc -vwnh -O2 -Sg -XS}             & \texttt{fpc -vwnf -O2 -Sg} \\
Haskell & \texttt{ghc -Wall -O -static -optl-static} & \texttt{ghc -Wall -O} \\
\hline
\end{tabular}
\label{compilercommandos}
\end{table}

Merk op dat wij statisch compileren i.v.m. het jurysysteem, maar wat
betreft foutmeldingen e.d. zijn de compiler-commando's in de kolom
``niet-statisch gelinked'' equivalent.

\subsubsection{Testen}

Als je programma succesvol gecompileerd is, wordt het gedraaid en de
uitvoer vergeleken met de correcte uitvoer van de jury. Er wordt eerst
gecontroleerd of je programma correct geeindigd is: als je programma
met een fout eindigt en het goede antwoord geeft, krijg je toch een
run-error! Er zijn een aantal beperkingen die aan je programma
opgelegd worden. Als je programma die overschrijdt, wordt het ook
afgebroken met een fout, zie (\ref{runlimits}).

Verder moet de uitvoer van jouw programma exact overeenkomen met de
uitvoer van de jury. Let dus goed op, dat je de uitvoer specificatie
volgt.

\subsubsection{Beperkingen}\label{runlimits}

Om hacken tegen te gaan, het jurysysteem stabiel te houden en iedereen
duidelijke, gelijke omstandigheden te geven, zijn er een aantal
beperkingen die aan iedere ingestuurde oplossing opgelegd worden:

\begin{description}[\setlabelphantom{aantal processen}]
\item[compile-tijd]
Je programma mag er maximaal \COMPILETIME\ seconden over doen om te
compileren. Daarna wordt het compileren afgebroken en levert dit een
compileerfout op. Dit zou in de praktijk nooit een probleem mogen
opleveren. Mocht dit toch gebeuren bij een normaal programma, laat het
dan de organisatie weten.

\item[source grootte]
De sourcecode van je programma mag maximaal \SOURCESIZE\ kilobytes
groot zijn. Bij het inzenden zul je hier al voor gewaarschuwd worden,
bij compileren levert dit ook een compileerfout.

\item[geheugen]
Je programma heeft tijdens het draaien maximaal \MEMLIMIT\ kilobytes
geheugen ter beschikking. Let op dat dit totaal geheugen is (inclusief
programma code, statisch en dynamisch gedefini\"eerde variabelen,
stack, \dots)! Als je programma meer probeert te gebruiken, zal het
waarschijnlijk afbreken, zodat dit een ``RUN-ERROR'' geeft.

\item[bestandsgrootte]
Hoewel je geen bestanden mag schrijven, wordt de standaard (fout)uitvoer
(stout/stderr) wel naar een bestand geschreven. De maximale grootte
van deze bestanden is \FILELIMIT\ kilobytes (per bestand).

\item[aantal processen]
Het is niet de bedoeling dat je programma meerdere processen (threads)
start. Dit heeft ook geen zin, want je programma heeft precies 1
processor volledig tot zijn beschikking. Om de stabiliteit van het
jurysysteem te bevorderen, kun je maximaal \PROCLIMIT\ processen
tegelijk draaien (inclusief de processen, waardoor je programma
gestart is).

Mensen, die nooit met meerdere processen geprogrammeerd hebben (of
niet weten wat dat is), hoeven zich geen zorgen te maken: standaard
draait een gecompileerd programma in \'e\'en proces.

\end{description}


\newpage
\appendix

\section{Code voorbeelden}\label{codevoorbeeld}

Hieronder staan een aantal voorbeelden van code om de invoer van een
probleem in te lezen en de uitvoer weg te schrijven.

De code hoort bij de volgende probleembeschrijving: gegeven een string
met een naam (\'e\'en woord), voer de string ``Hallo naam!'' uit.

Dit probleem zou de volgende in- en uitvoer kunnen hebben:

\begin{tabular}{|p{0.5\textwidth}|p{0.5\textwidth}|}
\hline
\textbf{Invoer} & \textbf{Uitvoer} \\
\hline
\verbatiminput{voorbeeld.in} &
\verbatiminput{voorbeeld.out} \\
\hline
\end{tabular}

Let op dat het op de eerste regel het getal 3 aangeeft, dat er 3
testgevallen volgen.

Een oplossing voor dit probleem in C:
\verbatiminput{voorbeeld.c}

Let op de \texttt{return 0;} aan het einde, zodat we geen
run-error krijgen!

Een oplossing in C++ kan als volgt:
\verbatiminput{voorbeeld.cc}

Een oplossing in Pascal:
\verbatiminput{voorbeeld.pas}

En tenslotte een oplossing in Java:
\verbatiminput{voorbeeld.java}

\end{document}
