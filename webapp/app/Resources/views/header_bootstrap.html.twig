<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <a class="navbar-brand hidden-sm-down" href="./">DOMjudge</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#menuDefault" aria-controls="menuDefault" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <style>
    #menuDefault ul li.nav-item {
      white-space: nowrap;
    }
  </style>
  <div class="collapse navbar-collapse" id="menuDefault">
    <ul class="navbar-nav mr-auto">

      <li class="nav-item">
        <a class="nav-link" href="{{ path('legacy.jury_index') }}" accesskey="h"><span class="octicon octicon-home"></span> home</a>
      </li>

      {% if is_granted('ROLE_BALLOON') %}
      <li class="nav-item">
        <a class="nav-link" href="{{ path('legacy.jury_balloons') }}" accesskey="b"><span class="octicon octicon-location"></span> balloons</a>
      </li>
      {% endif %}

      {% if is_granted('ROLE_JURY') %}
      <li class="nav-item">
        <a class="nav-link" href="{{ path('legacy.jury_problems') }}" accesskey="p"><span class="octicon octicon-book"></span> problems</a>
      </li>
      {% endif %}

      {% if is_granted('ROLE_ADMIN') %}
        <li class="nav-item">
          {% if updates['judgehosts']|length > 0 %}
            <a class="nav-link new" href="{{ path('legacy.jury_judgehosts') }}" accesskey="j" id="menu_judgehosts"><span class="octicon octicon-law"></span> judgehosts ({{ updates['judgehosts']|length }} down)</a>
          {% else %}
            <a class="nav-link" href="{{ path('legacy.jury_judgehosts') }}" accesskey="j" id="menu_judgehosts"><span class="octicon octicon-law"></span> judgehosts</a>
          {% endif %}
        </li>


        {% if updates['internal_error']|length > 0 %}
        <li class="nav-item">
          <a class="nav-link new" href="{{ path('legacy.jury_internal_errors') }}" accesskey="e" id="menu_internal_error"><span class="octicon octicon-zap"></span> internal error ({{ updates['internal_error']|length }} new)</a>
        </li>
        {% endif %}
      {% endif %}

      {% if is_granted('ROLE_JURY') %}
        <li class="nav-item">
          <a class="nav-link" href="{{ path('legacy.jury_teams') }}" accesskey="t"><span class="octicon octicon-organization"></span> teams</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="{{ path('legacy.jury_users') }}" accesskey="u"><span class="octicon octicon-person"></span> users</a>
        </li>

        <li class="nav-item">
          {% if updates['clarifications']|length > 0 %}
            <a class="nav-link new" href="{{ path('legacy.jury_clarifications') }}" accesskey="c" id="menu_clarifications"><span class="octicon octicon-comment-discussion"></span> clarifications ({{  updates['clarifications']|length }} new)</a>
          {% else %}
            <a class="nav-link" href="{{ path('legacy.jury_clarifications') }}" accesskey="c" id="menu_clarifications"><span class="octicon octicon-comment-discussion"></span> clarifications</a>
          {% endif %}
        </li>


        <li class="nav-item">
          <a class="nav-link" href="{{ path('legacy.jury_submissions') }}" accesskey="s"><span class="octicon octicon-file-code"></span> submissions</a>
        </li>

        <li class="nav-item">
          {% if updates['rejudgings']|length > 0 %}
            <a class="nav-link new" href="{{ path('legacy.jury_rejudgings') }}" accesskey="r" id="menu_rejudgings"><span class="octicon octicon-sync"></span> rejudgings ({{ updates['rejudgings']|length }} active)</a>
          {% else %}
            <a class="nav-link" href="{{ path('legacy.jury_rejudgings') }}" accesskey="r" id="menu_rejudgings"><span class="octicon octicon-sync"></span> rejudgings</a>
          {% endif %}
        </li>
      {% endif %}

      {% if have_printing %}
        <li class="nav-item">
          <a class="nav-link" href="{{ path('legacy.jury_print') }}" accesskey="p"><span class="octicon octicon-file-text"></span> print</a>
        </li>
      {% endif %}
      {% if is_granted('ROLE_JURY') %}
        <li class="nav-item">
          <a class="nav-link" href="{{ path('legacy.jury_scoreboard') }}" accesskey="b"><span class="octicon octicon-list-ordered"></span> scoreboard</a>
        </li>
      {% endif %}
      {% if is_granted('ROLE_TEAM') %}
        <li class="nav-item">
          <a class="nav-link" target="_top" href="{{ path('legacy.team_index') }}" accesskey="t"><span class="octicon octicon-arrow-right"></span> team</a>
        </li>
      {% endif %}
    </ul>
  </div>

  {# Render user information + logout button #}
  {% if is_granted('IS_AUTHENTICATED_FULLY') %}
    <div id="logoutbut">
      <a class="nav-link justify-content-center" href="{{path('legacy.logout')}}">
        <button type="button" class="btn btn-outline-info btn-sm" onclick="return confirmLogout();">
          <span class="octicon octicon-sign-out"></span> Logout (
          {% if app.user and app.user.getName() %}
            <abbr title="{{ app.user.getUsername() }}">{{ app.user.getName() }}</abbr>
          {% else %}
            {{ app.user.getUsername() }}
          {% endif %}
          )
        </button>
      </a>
    </div>
  {% endif %}



  <div class="navbar-text" style="white-space:nowrap;">
    <span style="padding-left: 10px;" class="octicon octicon-clock"></span>
    {% set now = 'now'|date('U') %}
    <span id="timeleft">
      {% if contest.getStartTime() < now and contest.getEndTime() >= now %}
        time left: {{ now|timediff(contest.getEndTime()) }}
      {% elseif contest.getActivateTime() < now and contest.getStartTime() >= now %}
        time to start: {{ now|timediff(contest.getStartTime()) }}
      {% endif %}
    </span>
  </div>
  <script type="text/javascript">
      var initial = 1537662210;
      var activatetime = -1;
      var starttime = -1;
      var endtime = -1;
      var offset = 0;
      var date = new Date(initial*1000);
      var timeleftelt = document.getElementById("timeleft");

      setInterval(function(){updateClock();},1000);
      updateClock();
  </script>
</nav>

<!--
  <div id="menutopright">
    <div id="clock">

      {% if is_granted('ROLE_JURY') or contests|length > 1 %}
        <div id="selectcontest">
          {# TODO: see about using a proper symfony form here #}
          <form id="selectcontestform" action="{{path('legacy.jury_change_contest')}}">
              <label for="cid">contest:</label>
              <select name="cid" id="cid">
                  {% if is_granted('ROLE_JURY') %}
                  <option value="-1">- No contest</option>
                  {% endif %}
                  {% for c in contests %}
                  <option value="{{c.cid}}" {% if c == contest %}selected="selected"{% endif %}>{{c.shortname}}</option>
                  {% endfor %}
              </select>
          </form>
          <script type="text/javascript">
            document.getElementById('cid').addEventListener('change', function() {
              document.getElementById('selectcontestform').submit();
            });
          </script>
        </div>
      {% endif %}
    </div>
  </div>
-->
